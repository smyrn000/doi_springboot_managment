import{_ as p,u as c,c as n,a as o,t as m,b as h,w as d,v as l,d as g,o as u,p as _,e as f}from"./index-g5GNysKY.js";const w={setup(){return{router:c()}},data(){return{username:"",password:"",error:!1,errorMessage:""}},methods:{clearForm(){this.username="",this.password=""},async login(){try{const s=await fetch("http://localhost:8080/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})});if(!s.ok)throw new Error("Login failed");const e=await s.json();e&&e.user?(console.log(e),localStorage.setItem("username",e.user.username),localStorage.setItem("user_id",e.user.id),localStorage.setItem("token",e.jwt),e.user.authorities[0].authority==="USER"?(localStorage.setItem("userRole","user"),this.router.push("/user")):(localStorage.setItem("userRole","admin"),this.router.push("/admin"))):(this.error=!0,this.errorMessage="Wrong Credentials")}catch(s){this.error=!0,this.clearForm(),this.errorMessage=s.message||"Login failed"}}}},a=s=>(_("data-v-fa5add72"),s=s(),f(),s),S={class:"login-container"},y=a(()=>o("h1",null,"Δημόσια Οικονομική Υπηρεσία",-1)),v={key:0,class:"error-message"},I={class:"form-group"},b=a(()=>o("label",{for:"username"},"Username:",-1)),M={class:"form-group"},k=a(()=>o("label",{for:"password"},"Password:",-1)),x=a(()=>o("button",{type:"submit"},"Login",-1));function V(s,e,L,R,r,i){return u(),n("div",S,[y,o("form",{onSubmit:e[2]||(e[2]=g((...t)=>i.login&&i.login(...t),["prevent"]))},[r.error?(u(),n("div",v,m(r.errorMessage),1)):h("",!0),o("div",I,[b,d(o("input",{type:"text",id:"username","onUpdate:modelValue":e[0]||(e[0]=t=>r.username=t)},null,512),[[l,r.username]])]),o("div",M,[k,d(o("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=t=>r.password=t)},null,512),[[l,r.password]])]),x],32)])}const j=p(w,[["render",V],["__scopeId","data-v-fa5add72"]]);export{j as default};
